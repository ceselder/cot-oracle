# CoT Oracle Training Config
# Set n: 0 to disable a task

tasks:
  full_recon:
    n: 40000
    description: "Reconstruct full CoT from stride activations"

  next_step:
    n: 30000
    description: "Predict next ~50 tokens of CoT"

  answer_pred:
    n: 20000
    description: "Predict final answer from partial CoT"

  partial_answer:
    n: 20000
    description: "What would the model answer if stopped at X%? (vLLM targets)"

  load_bearing:
    n: 15000
    description: "Is this CoT load-bearing or decorative?"

  correctness:
    n: 15000
    description: "Did the model get the right answer?"

  decorative:
    n: 15000
    description: "Is the CoT decorative?"

  domain:
    n: 0
    description: "What domain is this problem?"

  reasoning_term:
    n: 15000
    description: "Will the model emit </think> soon?"

  conv_qa:
    n: 10000
    description: "Answer conversational questions about the CoT"

# Training
training:
  lr: 0.00001
  batch_size: 8
  eval_batch_size: 2
  epochs: 1
  warmup_fraction: 0.1
  max_grad_norm: 1.0
  steering_coefficient: 1.0
  gradient_checkpointing: true
  task_order: shuffled    # "shuffled" (default) or "sequential" (train tasks one at a time)
  seed: 42

# Activation extraction
activations:
  stride: 5
  max_positions_per_layer: 20
  n_prompt_positions: 5
  position_encoding: false   # sinusoidal PE for activation vectors
  pe_alpha: 0.1              # PE mixing coefficient (only used if position_encoding: true)

# Eval
eval:
  eval_steps: 500
  save_steps: 2000
  unfaith_eval_steps: 5000
  unfaith_eval_items: 20

# Data
data:
  corpus: data/cot_corpus_v5/corpus_medium.jsonl
  precomputed_dir: data/precomputed
  concept_corpus: data/concept_corpus/corpus_full.jsonl
  cotqa_path: data/concept_corpus/corpus_full_conv_qa_llm.jsonl

# Model
model:
  name: Qwen/Qwen3-8B
  ao_checkpoint: adamkarvonen/checkpoints_latentqa_cls_past_lens_addition_Qwen3-8B
  fresh_lora: false

# Output
output:
  save_dir: checkpoints/v6
  wandb_project: cot_oracle
  wandb_entity: MATS10-CS-JB
  wandb_run: null  # auto-generated if null
